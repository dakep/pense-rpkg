# pense R package

[![R CMD
check](https://github.com/dakep/pense-rpkg/actions/workflows/check-package-extended.yml/badge.svg)](https://github.com/dakep/pense-rpkg/actions/workflows/check-package-extended.yml)

This R package implements the penalized adaptive elastic net S-estimator
(adaptive PENSE), the non-adaptive version (PENSE) and the penalized
M-step (PENSEM) as proposed in [Cohen Freue, et
al. (2019)](https://doi.org/10.1214/19-AOAS1269) and [Kepplinger
(2023)](https://doi.org/10.1016/j.csda.2023.107730). Hyper-parameter
selection is done by robust information sharing cross-validation
(RIS-CV; [Kepplinger & Wei
2025](https://doi.org/10.1080/00401706.2025.2540970)).

## Usage

The main function for most users is
[`adapense_cv()`](reference/pense_cv.md), which computes an adaptive
PENSE fit and estimates prediction performance for many values of the
penalization level.

``` r
library(pense)

# Generate dummy data with n=50 observations and p=25 possible predictors
# (of which only the first 3 are truly relevant).
n <- 50
p <- 25
set.seed(123)
x <- matrix(rt(n * p, df = 5), ncol = p)
y <- x[, 1] + 0.5 * x[, 2] + 2 * x[, 3] + rt(n, df = 2)

# Compute an adaptive PENSE fit with hyper-parameters alpha=0.8, exponent=2,
# and 50 different values for the penalization level.
# Prediction performance of the 50 fits for different penalization levels
# is estimated with 5-fold cross-validation,
# repeated 10 times (the more the better!).
# On selected platforms use 2 CPU cores.
set.seed(123) # Setting the seed is suggested for reproducibility of the CV results.
fit <- adapense_cv(x, y, alpha = 0.9, cv_k = 5, cv_repl = 10, ncores = 2)

# Visualize the estimated prediction performance using plot()
plot(fit)

# Summarize the model with best prediction performance using summary()
summary(fit)

# Summarize the model with "almost as-good prediction performance" as the best
# model using summary(lambda = "se")
summary(fit, lambda = "se")
```

The user can also compute a non-adaptive PENSE fit by using
[`pense_cv()`](reference/pense_cv.md) in place of
[`adapense_cv()`](reference/pense_cv.md) or a PENSEM fit by using
`pensem_cv()`.

## Detailed examples

The package vignette [Estimating predictive
models](https://dakep.github.io/pense-rpkg/articles/computing_adapense.html)
demonstrate in more detail how to compute adaptive and non-adaptive
PENSE estimates.

## Installation

To install the latest release from CRAN, run the following R code in the
R console:

``` r
install.packages("pense")
```

The most recent development version can be installed directly from
github using the [devtools](https://cran.r-project.org/package=devtools)
package:

``` r
# Install the most recent development version:
devtools::install_github("dakep/pense-rpkg")
```

## References

- D. Kepplinger and S. Wei, “Information sharing for robust and stable
  cross-validation,” *Technometrics*, 2025, [doi:
  10.1080/00401706.2025.2540970](https://doi.org/10.1080/00401706.2025.2540970).
- D. Kepplinger, “Robust variable selection and estimation via adaptive
  elastic net S-estimators for linear regression,” *Computational
  Statistics & Data Analysis,* vol. 183, 2023, [doi:
  10.1016/j.csda.2023.107730](https://doi.org/10.1016/j.csda.2023.107730).
- G. V. Cohen Freue, D. Kepplinger, M. Salibián-Barrera, and E. Smucler,
  “Robust elastic net estimators for variable selection and
  identification of proteomic biomarkers,” *Annals of Applied
  Statistics,* vol. 13, no. 4, pp. 2065–2090, 2019, [doi:
  10.1214/19-AOAS1269](https://doi.org/10.1214/19-AOAS1269).

# Package index

## Robust fitting of linear regression models

### Fitting and estimating prediction performance

Fit linear regression models for a set of penalization levels and
estimate the prediction performance via cross-validation.

- [`change_cv_measure()`](change_cv_measure.md) : Change the
  Cross-Validation Measure
- [`pense_cv()`](pense_cv.md) [`adapense_cv()`](pense_cv.md) :
  Cross-validation for (Adaptive) PENSE Estimates
- [`regmest_cv()`](regmest_cv.md) [`adamest_cv()`](regmest_cv.md) :
  Cross-validation for (Adaptive) Elastic Net M-Estimates

### Fitting only

- [`pense()`](pense.md) : Compute (Adaptive) Elastic Net S-Estimates of
  Regression
- [`regmest()`](regmest.md) : Compute (Adaptive) Elastic Net M-Estimates
  of Regression

## Plotting and printing

Methods for plotting and summarizing fits.

- [`plot(`*`<pense_cvfit>`*`)`](plot.pense_cvfit.md) : Plot Method for
  Penalized Estimates With Cross-Validation
- [`plot(`*`<pense_fit>`*`)`](plot.pense_fit.md) : Plot Method for
  Penalized Estimates
- [`prediction_performance()`](prediction_performance.md)
  [`print(`*`<pense_pred_perf>`*`)`](prediction_performance.md) :
  Prediction Performance of Adaptive PENSE Fits
- [`summary(`*`<pense_cvfit>`*`)`](summary.pense_cvfit.md)
  [`print(`*`<pense_cvfit>`*`)`](summary.pense_cvfit.md) : Summarize
  Cross-Validated PENSE Fit

## Extracting information

Methods for extracting coefficient estimates and predicting values.

- [`coef(`*`<pense_cvfit>`*`)`](coef.pense_cvfit.md) : Extract
  Coefficient Estimates
- [`coef(`*`<pense_fit>`*`)`](coef.pense_fit.md) : Extract Coefficient
  Estimates
- [`predict(`*`<pense_cvfit>`*`)`](predict.pense_cvfit.md) : Predict
  Method for PENSE Fits
- [`predict(`*`<pense_fit>`*`)`](predict.pense_fit.md) : Predict Method
  for PENSE Fits
- [`residuals(`*`<pense_cvfit>`*`)`](residuals.pense_cvfit.md) : Extract
  Residuals
- [`residuals(`*`<pense_fit>`*`)`](residuals.pense_fit.md) : Extract
  Residuals

## Robust location and scale

Compute robust location and scale estimates.

- [`mloc()`](mloc.md) : Compute the M-estimate of Location
- [`mlocscale()`](mlocscale.md) : Compute the M-estimate of Location and
  Scale
- [`mscale()`](mscale.md) : Compute the M-Scale of Centered Values
- [`tau_size()`](tau_size.md) : Compute the Tau-Scale of Centered Values

## Non-robust methods

Non-robust methods for fitting linear regression models.

- [`elnet()`](elnet.md) : Compute the Least Squares (Adaptive) Elastic
  Net Regularization Path
- [`elnet_cv()`](elnet_cv.md) : Cross-validation for Least-Squares
  (Adaptive) Elastic Net Estimates

## Advanced functionality

### Controlling the Robust EN algorithm

Options to choose and control the algorithm to optimize robust EN
objective functions

- [`cd_algorithm_options()`](cd_algorithm_options.md) : Coordinate
  Descent (CD) Algorithm to Compute Penalized Elastic Net S-estimates
- [`mm_algorithm_options()`](mm_algorithm_options.md) : MM-Algorithm to
  Compute Penalized Elastic Net S- and M-Estimates

### Controlling the EN algorithm

Options to choose and control the algorithm to optimize least-squares EN
problems.

- [`en_admm_options()`](en_admm_options.md) : Use the ADMM Elastic Net
  Algorithm
- [`en_algorithm_options`](en_algorithm_options.md) : Control the
  Algorithm to Compute (Weighted) Least-Squares Elastic Net Estimates
- [`en_cd_options()`](en_cd_options.md) : Use Coordinate Descent to
  Solve Elastic Net Problems
- [`en_dal_options()`](en_dal_options.md) : Use the DAL Elastic Net
  Algorithm
- [`en_lars_options()`](en_lars_options.md) : Use the LARS Elastic Net
  Algorithm

### Rho/Psi functions

- [`mscale_algorithm_options()`](mscale_algorithm_options.md) : Options
  for the M-scale Estimation Algorithm
- [`consistency_const()`](rho-tuning-constants.md)
  [`efficiency_const()`](rho-tuning-constants.md) : Get the Constant for
  Consistency for the M-Scale and for Efficiency for the M-estimate of
  Location
- [`rho_function()`](rho_function.md) : List Available Rho Functions

### Initial estimates

Manually compute and alter initial estimates.

- [`enpy_initial_estimates()`](enpy_initial_estimates.md) : ENPY Initial
  Estimates for EN S-Estimators
- [`enpy_options()`](enpy_options.md) : Options for the ENPY Algorithm
- [`prinsens()`](prinsens.md) : Principal Sensitivity Components
- [`starting_point()`](starting_point.md)
  [`as_starting_point()`](starting_point.md) : Create Starting Points
  for the PENSE Algorithm

### Miscellaneous

# Articles

### All vignettes

- [Estimating predictive models](computing_adapense.md):
- [Controlling the grid of penalization levels](lambda_grids.md):
