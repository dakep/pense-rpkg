<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Cross-validation for (Adaptive) PENSE Estimates — pense_cv • pense</title><!-- katex math --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><script src="../katex-auto.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Cross-validation for (Adaptive) PENSE Estimates — pense_cv"><meta name="description" content="Perform (repeated) K-fold cross-validation for pense().
adapense_cv() is a convenience wrapper to compute adaptive
PENSE estimates."><meta property="og:description" content="Perform (repeated) K-fold cross-validation for pense().
adapense_cv() is a convenience wrapper to compute adaptive
PENSE estimates."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pense</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.5.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/computing_adapense.html">Estimating predictive models</a></li>
    <li><a class="dropdown-item" href="../articles/lambda_grids.html">Controlling the grid of penalization levels</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/dakep/pense-rpkg/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Cross-validation for (Adaptive) PENSE Estimates</h1>
      <small class="dont-index">Source: <a href="https://github.com/dakep/pense-rpkg/blob/main/R/pense_regression.R" class="external-link"><code>R/pense_regression.R</code></a></small>
      <div class="d-none name"><code>pense_cv.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Perform (repeated) K-fold cross-validation for <code><a href="pense.html">pense()</a></code>.</p>
<p><code>adapense_cv()</code> is a convenience wrapper to compute adaptive
PENSE estimates.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">pense_cv</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  standardize <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">lambda</span>,</span>
<span>  <span class="va">cv_k</span>,</span>
<span>  cv_repl <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  cv_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ris"</span>, <span class="st">"naive"</span><span class="op">)</span>,</span>
<span>  cv_metric <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tau_size"</span>, <span class="st">"mape"</span>, <span class="st">"rmspe"</span>, <span class="st">"auroc"</span><span class="op">)</span>,</span>
<span>  ris_min_similarity <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  fit_all <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  fold_starts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"full"</span>, <span class="st">"enpy"</span>, <span class="st">"both"</span><span class="op">)</span>,</span>
<span>  <span class="va">cv_algorithm_opts</span>,</span>
<span>  cl <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">adapense_cv</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">alpha</span>, alpha_preliminary <span class="op">=</span> <span class="fl">0</span>, exponent <span class="op">=</span> <span class="fl">1</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p><code>n</code> by <code>p</code> matrix of numeric predictors.</p></dd>


<dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>vector of response values of length <code>n</code>.
For binary classification, <code>y</code> should be a factor with 2 levels.</p></dd>


<dt id="arg-standardize">standardize<a class="anchor" aria-label="anchor" href="#arg-standardize"></a></dt>
<dd><p>whether to standardize the <code>x</code> variables prior to fitting
the PENSE estimates. Can also be set to <code>"cv_only"</code>, in which case the
input data is not standardized, but the training data in the CV folds is
scaled to match the scaling of the input data.
Coefficients are always returned on the original scale.
This can fail for variables with a large proportion of a single value
(e.g., zero-inflated data).
In this case, either compute with <code>standardize = FALSE</code> or standardize
the data manually.</p></dd>


<dt id="arg-lambda">lambda<a class="anchor" aria-label="anchor" href="#arg-lambda"></a></dt>
<dd><p>optional user-supplied sequence of penalization levels. If given and not <code>NULL</code>,
<code>nlambda</code> and <code>lambda_min_ratio</code> are ignored.</p></dd>


<dt id="arg-cv-k">cv_k<a class="anchor" aria-label="anchor" href="#arg-cv-k"></a></dt>
<dd><p>number of folds per cross-validation.</p></dd>


<dt id="arg-cv-repl">cv_repl<a class="anchor" aria-label="anchor" href="#arg-cv-repl"></a></dt>
<dd><p>number of cross-validation replications.</p></dd>


<dt id="arg-cv-type">cv_type<a class="anchor" aria-label="anchor" href="#arg-cv-type"></a></dt>
<dd><p>what kind of cross-validation should be performed:
robust information sharing (<code>ris</code>) or standard (<code>naive</code>) CV.</p></dd>


<dt id="arg-cv-metric">cv_metric<a class="anchor" aria-label="anchor" href="#arg-cv-metric"></a></dt>
<dd><p>only for <code>cv_type='naive'</code>.
Either a string specifying the performance metric to use, or a function to
evaluate prediction errors in a single CV replication.
If a function, the number of arguments define the data the function receives.
If the function takes a single argument, it is called with a single numeric vector of
prediction errors.
If the function takes two or more arguments, it is called with the predicted values as
first argument and the true values as second argument.
The function must always return a single numeric value quantifying the prediction performance.
The order of the given values corresponds to the order in the input data.</p></dd>


<dt id="arg-ris-min-similarity">ris_min_similarity<a class="anchor" aria-label="anchor" href="#arg-ris-min-similarity"></a></dt>
<dd><p>minimum average similarity of the CV solutions to be considered
(between 0 and 1).
If no CV solution satisfies this lower bound, the best CV solution will be used regardless
of similarity.</p></dd>


<dt id="arg-fit-all">fit_all<a class="anchor" aria-label="anchor" href="#arg-fit-all"></a></dt>
<dd><p>only for <code>cv_type='naive'</code>.
If <code>TRUE</code>, fit the model for all penalization levels.
Can also be any combination of <code>"min"</code> and <code>"{x}-se"</code>, in which case only models at the
penalization level with smallest average CV accuracy, or within <code>{x}</code> standard errors,
respectively.
Setting <code>fit_all</code> to <code>FALSE</code> is equivalent to <code>"min"</code>.
Applies to all <code>alpha</code> value.</p></dd>


<dt id="arg-fold-starts">fold_starts<a class="anchor" aria-label="anchor" href="#arg-fold-starts"></a></dt>
<dd><p>how to determine starting values in the
cross-validation folds. If <code>"full"</code> (default), use the best solution from
the fit to the full data as starting value. This implies
<code>fit_all=TRUE</code>.
If <code>"enpy"</code> compute separate ENPY initial estimates in each fold.
The option <code>"both"</code> uses both.
These starts are in addition to the starts provided in <code>other_starts</code>.</p></dd>


<dt id="arg-cv-algorithm-opts">cv_algorithm_opts<a class="anchor" aria-label="anchor" href="#arg-cv-algorithm-opts"></a></dt>
<dd><p>Override algorithm options for the CV iterations.
This is usually not necessary, unless the user wants to change the number of solutions
retained for the CV training data.</p></dd>


<dt id="arg-cl">cl<a class="anchor" aria-label="anchor" href="#arg-cl"></a></dt>
<dd><p>a <a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">parallel</a> cluster. Can only be used in combination with
<code>ncores = 1</code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Arguments passed on to <code><a href="pense.html">pense</a></code></p><dl><dt><code>nlambda</code></dt>
<dd><p>number of penalization levels.</p></dd>

    <dt><code>lambda_min_ratio</code></dt>
<dd><p>Smallest value of the penalization level as a fraction of the largest
level (i.e., the smallest value for which all coefficients are zero). The default depends on
the sample size relative to the number of variables and <code>alpha</code>. If more observations than
variables are available, the default is <code>1e-3 * alpha</code>, otherwise <code>1e-2 * alpha</code>.</p></dd>

    <dt><code>nlambda_enpy</code></dt>
<dd><p>number of penalization levels where the EN-PY initial estimate is computed.</p></dd>

    <dt><code>penalty_loadings</code></dt>
<dd><p>a vector of positive penalty loadings (a.k.a. weights) for different
penalization of each coefficient. Only allowed for <code>alpha</code> &gt; 0.</p></dd>

    <dt><code>enpy_lambda</code></dt>
<dd><p>optional user-supplied sequence of penalization levels at which EN-PY
initial estimates are computed. If given and not <code>NULL</code>, <code>nlambda_enpy</code> is ignored.</p></dd>

    <dt><code>other_starts</code></dt>
<dd><p>a list of other staring points, created by <code><a href="starting_point.html">starting_point()</a></code>.
If the output of <code><a href="enpy_initial_estimates.html">enpy_initial_estimates()</a></code> is given, the starting points will be <em>shared</em>
among all penalization levels.
Note that if a the starting point is <em>specific</em> to a penalization level, this penalization
level is added to the grid of penalization levels (either the manually specified grid in
<code>lambda</code> or the automatically generated grid of size <code>nlambda</code>).
If <code>standardize = TRUE</code>, the starting points are also scaled.</p></dd>

    <dt><code>intercept</code></dt>
<dd><p>include an intercept in the model.</p></dd>

    <dt><code>bdp</code></dt>
<dd><p>desired breakdown point of the estimator, between 0.05 and 0.5. The actual
breakdown point may be slightly larger/smaller to avoid instabilities of the S-loss.</p></dd>

    <dt><code>cc</code></dt>
<dd><p>tuning constant for the S-estimator. Default is chosen based on the breakdown
point <code>bdp</code>. This affects the estimated coefficients only if
<code>standardize=TRUE</code>. Otherwise only the estimated scale of the residuals
would be affected.</p></dd>

    <dt><code>eps</code></dt>
<dd><p>numerical tolerance.</p></dd>

    <dt><code>explore_solutions</code></dt>
<dd><p>number of solutions to keep after the exploration step.
The best <code>explore_solutions</code> are then iterated to full numerical tolerance <code>eps</code>.
If 0, all non-duplicated solutions are kept.</p></dd>

    <dt><code>explore_tol,explore_it</code></dt>
<dd><p>numerical tolerance and maximum number of iterations for
exploring possible solutions. The tolerance should be (much) looser than <code>eps</code> to be useful,
and the number of iterations should also be much smaller than the maximum number of
iterations given via <code>algorithm_opts</code>.
<code>explore_tol</code> is also used to determine if two solutions are equal in the exploration stage.</p></dd>

    <dt><code>max_solutions</code></dt>
<dd><p>retain only up to <code>max_solutions</code> unique solutions per penalization level.</p></dd>

    <dt><code>comparison_tol</code></dt>
<dd><p>numeric tolerance to determine if two solutions are equal.
The comparison is first done on the absolute difference in the value of the objective
function at the solution. If this is less than <code>comparison_tol</code>, two solutions are deemed
equal if the squared difference of the intercepts is less than <code>comparison_tol</code> and the
squared \(L_2\) norm of the difference vector is less than <code>comparison_tol</code>.</p></dd>

    <dt><code>add_zero_based</code></dt>
<dd><p>also consider the 0-based regularization path. See details for a
description.</p></dd>

    <dt><code>enpy_specific</code></dt>
<dd><p>use the EN-PY initial estimates only at the penalization level they
are computed for. See details for a description.</p></dd>

    <dt><code>carry_forward</code></dt>
<dd><p>carry the best solutions forward to the next penalty
level.</p></dd>

    <dt><code>sparse</code></dt>
<dd><p>use sparse coefficient vectors.</p></dd>

    <dt><code>ncores</code></dt>
<dd><p>number of CPU cores to use in parallel. By default, only one CPU core is used.
Not supported on all platforms, in which case a warning is given.</p></dd>

    <dt><code>algorithm_opts</code></dt>
<dd><p>options for the MM algorithm to compute the estimates.
See <code><a href="mm_algorithm_options.html">mm_algorithm_options()</a></code> for details.</p></dd>

    <dt><code>mscale_opts</code></dt>
<dd><p>options for the M-scale estimation. See <code><a href="mscale_algorithm_options.html">mscale_algorithm_options()</a></code>
for details.</p></dd>

    <dt><code>enpy_opts</code></dt>
<dd><p>options for the ENPY initial estimates, created with the
<code><a href="enpy_options.html">enpy_options()</a></code> function. See <code><a href="enpy_initial_estimates.html">enpy_initial_estimates()</a></code> for details.</p></dd>

    <dt><code>cv_k,cv_objective</code></dt>
<dd><p>deprecated and ignored. See <code>pense_cv()</code> for estimating
prediction performance via cross-validation.</p></dd>


</dl></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>elastic net penalty mixing parameter with \(0 \le \alpha \le 1\).
<code>alpha = 1</code> is the LASSO penalty, and <code>alpha = 0</code> the Ridge penalty.
Can be a vector of several values, but <code>alpha = 0</code> cannot be mixed with other values.</p></dd>


<dt id="arg-alpha-preliminary">alpha_preliminary<a class="anchor" aria-label="anchor" href="#arg-alpha-preliminary"></a></dt>
<dd><p><code>alpha</code> parameter for the preliminary estimate.</p></dd>


<dt id="arg-exponent">exponent<a class="anchor" aria-label="anchor" href="#arg-exponent"></a></dt>
<dd><p>the exponent for computing the penalty loadings based on
the preliminary estimate.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a list-like object with the same components as returned by <code><a href="pense.html">pense()</a></code>,
plus the following:</p><dl><dt><code>cvres</code></dt>
<dd><p>data frame of average cross-validated performance.</p></dd>


</dl><p>a list-like object as returned by <code>pense_cv()</code> plus the following</p><dl><dt><code>preliminary</code></dt>
<dd><p>the CV results for the preliminary estimate.</p></dd>

<dt><code>exponent</code></dt>
<dd><p>exponent used to compute the penalty loadings.</p></dd>

<dt><code>penalty_loadings</code></dt>
<dd><p>penalty loadings used for the
adaptive PENSE estimate.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The built-in CV metrics are</p><dl><dt><code>"tau_size"</code></dt>
<dd><p>\(\tau\)-size of the prediction error, computed by
<code><a href="tau_size.html">tau_size()</a></code> (default).</p></dd>

<dt><code>"mape"</code></dt>
<dd><p>Median absolute prediction error.</p></dd>

<dt><code>"rmspe"</code></dt>
<dd><p>Root mean squared prediction error.</p></dd>

<dt><code>"auroc"</code></dt>
<dd><p>Area under the receiver operator characteristic curve (actually 1 - AUROC).
Only sensible for binary responses.</p></dd>


</dl><p><code>adapense_cv()</code> is a convenience wrapper which performs 3 steps:</p><ol><li><p>compute preliminary estimates via
<code>pense_cv(..., alpha = alpha_preliminary)</code>,</p></li>
<li><p>computes the penalty loadings from the estimate <code>beta</code> with best
prediction performance by
<code>adapense_loadings = 1 / abs(beta)^exponent</code>, and</p></li>
<li><p>compute the adaptive PENSE estimates via
<code>pense_cv(..., penalty_loadings = adapense_loadings)</code>.</p></li>
</ol></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="pense.html">pense()</a></code> for computing regularized S-estimates without
cross-validation.</p>
<p><code><a href="coef.pense_cvfit.html">coef.pense_cvfit()</a></code> for extracting coefficient estimates.</p>
<p><code><a href="plot.pense_cvfit.html">plot.pense_cvfit()</a></code> for plotting the CV performance or the
regularization path.</p>
<p>Other functions to compute robust estimates with CV:
<code><a href="change_cv_measure.html">change_cv_measure()</a></code>,
<code><a href="regmest_cv.html">regmest_cv()</a></code></p>
<p>Other functions to compute robust estimates with CV:
<code><a href="change_cv_measure.html">change_cv_measure()</a></code>,
<code><a href="regmest_cv.html">regmest_cv()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Compute the adaptive PENSE regularization path for Freeny's</span></span></span>
<span class="r-in"><span><span class="co"># revenue data (see ?freeny)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">freeny</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">freeny</span><span class="op">[</span> , <span class="fl">2</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Either use the convenience function directly ...</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ada_convenience</span> <span class="op">&lt;-</span> <span class="fu">adapense_cv</span><span class="op">(</span><span class="va">x</span>, <span class="va">freeny</span><span class="op">$</span><span class="va">y</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>,</span></span>
<span class="r-in"><span>                               cv_repl <span class="op">=</span> <span class="fl">2</span>, cv_k <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ... or compute the steps manually:</span></span></span>
<span class="r-in"><span><span class="co"># Step 1: Compute preliminary estimates with CV</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">preliminary_estimate</span> <span class="op">&lt;-</span> <span class="fu">pense_cv</span><span class="op">(</span><span class="va">x</span>, <span class="va">freeny</span><span class="op">$</span><span class="va">y</span>, alpha <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>                                 cv_repl <span class="op">=</span> <span class="fl">2</span>, cv_k <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">preliminary_estimate</span>, se_mult <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Step 2: Use the coefficients with best prediction performance</span></span></span>
<span class="r-in"><span><span class="co"># to define the penalty loadings:</span></span></span>
<span class="r-in"><span><span class="va">prelim_coefs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">preliminary_estimate</span>, lambda <span class="op">=</span> <span class="st">'min'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pen_loadings</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">prelim_coefs</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Step 3: Compute the adaptive PENSE estimates and estimate</span></span></span>
<span class="r-in"><span><span class="co"># their prediction performance.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ada_manual</span> <span class="op">&lt;-</span> <span class="fu">pense_cv</span><span class="op">(</span><span class="va">x</span>, <span class="va">freeny</span><span class="op">$</span><span class="va">y</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>,</span></span>
<span class="r-in"><span>                       cv_repl <span class="op">=</span> <span class="fl">2</span>, cv_k <span class="op">=</span> <span class="fl">4</span>,</span></span>
<span class="r-in"><span>                       penalty_loadings <span class="op">=</span> <span class="va">pen_loadings</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Visualize the prediction performance and coefficient path of</span></span></span>
<span class="r-in"><span><span class="co"># the adaptive PENSE estimates (manual vs. automatic)</span></span></span>
<span class="r-in"><span><span class="va">def.par</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>no.readonly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/layout.html" class="external-link">layout</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, ncol <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ada_convenience</span><span class="op">$</span><span class="va">preliminary</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">preliminary_estimate</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ada_convenience</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ada_manual</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="pense_cv-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">def.par</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by David Kepplinger, Matías Salibián-Barrera, Gabriela Cohen Freue.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

