<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Compute Penalized Elastic Net M-Estimates from PENSE — pensem_cv • pense</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Compute Penalized Elastic Net M-Estimates from PENSE — pensem_cv"><meta property="og:description" content="This is a convenience wrapper around pense_cv() and regmest_cv(), for the common use-case of computing
a highly-robust S-estimate followed by a more efficient M-estimate using the scale of the residuals from the
S-estimate."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pense</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.1.1-902</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/computing_adapense.html">Estimating predictive models</a>
    </li>
    <li>
      <a href="../articles/lambda_grids.html">Controlling the grid of penalization levels</a>
    </li>
    <li>
      <a href="../articles/migration_guide.html">Migrating from pense version 1.x to 2.x</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/dakep/pense-rpkg/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compute Penalized Elastic Net M-Estimates from PENSE</h1>
    <small class="dont-index">Source: <a href="https://github.com/dakep/pense-rpkg/blob/HEAD/R/pensem_regression.R" class="external-link"><code>R/pensem_regression.R</code></a></small>
    <div class="hidden name"><code>pensem_cv.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This is a convenience wrapper around <code><a href="pense_cv.html">pense_cv()</a></code> and <code><a href="regmest_cv.html">regmest_cv()</a></code>, for the common use-case of computing
a highly-robust S-estimate followed by a more efficient M-estimate using the scale of the residuals from the
S-estimate.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">pensem_cv</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for default</span></span>
<span><span class="fu">pensem_cv</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  nlambda <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  <span class="va">lambda_min_ratio</span>,</span>
<span>  <span class="va">lambda_m</span>,</span>
<span>  <span class="va">lambda_s</span>,</span>
<span>  standardize <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">penalty_loadings</span>,</span>
<span>  intercept <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  bdp <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>  ncores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  sparse <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  eps <span class="op">=</span> <span class="fl">1e-06</span>,</span>
<span>  cc <span class="op">=</span> <span class="fl">4.7</span>,</span>
<span>  cv_k <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  cv_repl <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  cl <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cv_metric <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tau_size"</span>, <span class="st">"mape"</span>, <span class="st">"rmspe"</span><span class="op">)</span>,</span>
<span>  add_zero_based <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  explore_solutions <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  explore_tol <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  max_solutions <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  fit_all <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  comparison_tol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">eps</span><span class="op">)</span>,</span>
<span>  algorithm_opts <span class="op">=</span> <span class="fu"><a href="mm_algorithm_options.html">mm_algorithm_options</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  mscale_opts <span class="op">=</span> <span class="fu"><a href="mscale_algorithm_options.html">mscale_algorithm_options</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  nlambda_enpy <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  enpy_opts <span class="op">=</span> <span class="fu"><a href="enpy_options.html">enpy_options</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for pense_cvfit</span></span>
<span><span class="fu">pensem_cv</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">scale</span>,</span>
<span>  <span class="va">alpha</span>,</span>
<span>  nlambda <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  <span class="va">lambda_min_ratio</span>,</span>
<span>  <span class="va">lambda_m</span>,</span>
<span>  standardize <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">penalty_loadings</span>,</span>
<span>  intercept <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  bdp <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>  ncores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  sparse <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  eps <span class="op">=</span> <span class="fl">1e-06</span>,</span>
<span>  cc <span class="op">=</span> <span class="fl">4.7</span>,</span>
<span>  cv_k <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  cv_repl <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  cl <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cv_metric <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tau_size"</span>, <span class="st">"mape"</span>, <span class="st">"rmspe"</span><span class="op">)</span>,</span>
<span>  add_zero_based <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  explore_solutions <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  explore_tol <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  max_solutions <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  fit_all <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  comparison_tol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">eps</span><span class="op">)</span>,</span>
<span>  algorithm_opts <span class="op">=</span> <span class="fu"><a href="mm_algorithm_options.html">mm_algorithm_options</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  mscale_opts <span class="op">=</span> <span class="fu"><a href="mscale_algorithm_options.html">mscale_algorithm_options</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">x_train</span>,</span>
<span>  <span class="va">y_train</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>either a numeric matrix of predictor values, or a cross-validated PENSE fit from <code><a href="pense_cv.html">pense_cv()</a></code>.</p></dd>


<dt>...</dt>
<dd><p>ignored. See the section on deprecated parameters below.</p></dd>


<dt>y</dt>
<dd><p>vector of response values of length <code>n</code>.
For binary classification, <code>y</code> should be a factor with 2 levels.</p></dd>


<dt>alpha</dt>
<dd><p>elastic net penalty mixing parameter with \(0 \le \alpha \le 1\).
<code>alpha = 1</code> is the LASSO penalty, and <code>alpha = 0</code> the Ridge penalty.
Can be a vector of several values, but <code>alpha = 0</code> cannot be mixed with other values.</p></dd>


<dt>nlambda</dt>
<dd><p>number of penalization levels.</p></dd>


<dt>lambda_min_ratio</dt>
<dd><p>Smallest value of the penalization level as a fraction of the largest
level (i.e., the smallest value for which all coefficients are zero). The default depends on
the sample size relative to the number of variables and <code>alpha</code>. If more observations than
variables are available, the default is <code>1e-3 * alpha</code>, otherwise <code>1e-2 * alpha</code>.</p></dd>


<dt>lambda_m, lambda_s</dt>
<dd><p>optional user-supplied sequence of penalization levels for the S- and M-estimates.
If given and not <code>NULL</code>, <code>nlambda</code> and <code>lambda_min_ratio</code> are ignored for the respective estimate (S and/or M).</p></dd>


<dt>standardize</dt>
<dd><p>logical flag to standardize the <code>x</code> variables prior to fitting the PENSE
estimates. Coefficients are always returned on the original scale. This can fail for
variables with a large proportion of a single value (e.g., zero-inflated data).
In this case, either compute with <code>standardize = FALSE</code> or standardize the data manually.</p></dd>


<dt>penalty_loadings</dt>
<dd><p>a vector of positive penalty loadings (a.k.a. weights) for different
penalization of each coefficient. Only allowed for <code>alpha</code> &gt; 0.</p></dd>


<dt>intercept</dt>
<dd><p>include an intercept in the model.</p></dd>


<dt>bdp</dt>
<dd><p>desired breakdown point of the estimator, between 0.05 and 0.5. The actual
breakdown point may be slightly larger/smaller to avoid instabilities of the S-loss.</p></dd>


<dt>ncores</dt>
<dd><p>number of CPU cores to use in parallel. By default, only one CPU core is used.
Not supported on all platforms, in which case a warning is given.</p></dd>


<dt>sparse</dt>
<dd><p>use sparse coefficient vectors.</p></dd>


<dt>eps</dt>
<dd><p>numerical tolerance.</p></dd>


<dt>cc</dt>
<dd><p>cutoff constant for Tukey's bisquare \(\rho\) function in the M-estimation objective function.</p></dd>


<dt>cv_k</dt>
<dd><p>number of folds per cross-validation.</p></dd>


<dt>cv_repl</dt>
<dd><p>number of cross-validation replications.</p></dd>


<dt>cl</dt>
<dd><p>a <a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">parallel</a> cluster. Can only be used in combination with
<code>ncores = 1</code>.</p></dd>


<dt>cv_metric</dt>
<dd><p>either a string specifying the performance metric to use, or a function to
evaluate prediction errors in a single CV replication.
If a function, the number of arguments define the data the function receives.
If the function takes a single argument, it is called with a single numeric vector of
prediction errors.
If the function takes two or more arguments, it is called with the predicted values as
first argument and the true values as second argument.
The function must always return a single numeric value quantifying the prediction performance.
The order of the given values corresponds to the order in the input data.</p></dd>


<dt>add_zero_based</dt>
<dd><p>also consider the 0-based regularization path. See details for a
description.</p></dd>


<dt>explore_solutions</dt>
<dd><p>number of solutions to compute up to the desired precision <code>eps</code>.</p></dd>


<dt>max_solutions</dt>
<dd><p>only retain up to <code>max_solutions</code> unique solutions per penalization level.</p></dd>


<dt>fit_all</dt>
<dd><p>If <code>TRUE</code>, fit the model for all penalization levels.
Can also be any combination of <code>"min"</code> and <code>"{x}-se"</code>, in which case only models at the
penalization level with smallest average CV accuracy, or within <code>{x}</code> standard errors,
respectively.
Setting <code>fit_all</code> to <code>FALSE</code> is equivalent to <code>"min"</code>.
Applies to all <code>alpha</code> value.</p></dd>


<dt>comparison_tol</dt>
<dd><p>numeric tolerance to determine if two solutions are equal.
The comparison is first done on the absolute difference in the value of the objective
function at the solution If this is less than <code>comparison_tol</code>, two solutions are deemed
equal if the squared difference of the intercepts is less than <code>comparison_tol</code> and the
squared \(L_2\) norm of the difference vector is less than <code>comparison_tol</code>.</p></dd>


<dt>algorithm_opts</dt>
<dd><p>options for the MM algorithm to compute the estimates.
See <code><a href="mm_algorithm_options.html">mm_algorithm_options()</a></code> for details.</p></dd>


<dt>mscale_opts</dt>
<dd><p>options for the M-scale estimation. See <code><a href="mscale_algorithm_options.html">mscale_algorithm_options()</a></code>
for details.</p></dd>


<dt>nlambda_enpy</dt>
<dd><p>number of penalization levels where the EN-PY initial estimate is computed.</p></dd>


<dt>enpy_opts</dt>
<dd><p>options for the ENPY initial estimates, created with the
<code><a href="enpy_options.html">enpy_options()</a></code> function. See <code><a href="enpy_initial_estimates.html">enpy_initial_estimates()</a></code> for details.</p></dd>


<dt>scale</dt>
<dd><p>initial scale estimate to use in the M-estimation. By default the S-scale from the PENSE fit is used.</p></dd>


<dt>x_train, y_train</dt>
<dd><p>override arguments <code>x</code> and <code>y</code> as provided in the call to <code><a href="pense_cv.html">pense_cv()</a></code>. This is useful if
the arguments in the <code><a href="pense_cv.html">pense_cv()</a></code> call are not available in the current environment.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>an object of cross-validated regularized M-estimates as returned from <code><a href="regmest_cv.html">regmest_cv()</a></code>.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The built-in CV metrics are</p><dl><dt><code>"tau_size"</code></dt>
<dd><p>\(\tau\)-size of the prediction error, computed by
<code><a href="tau_size.html">tau_size()</a></code> (default).</p></dd>

<dt><code>"mape"</code></dt>
<dd><p>Median absolute prediction error.</p></dd>

<dt><code>"rmspe"</code></dt>
<dd><p>Root mean squared prediction error.</p></dd>

<dt><code>"auroc"</code></dt>
<dd><p>Area under the receiver operator characteristic curve (actually 1 - AUROC).
Only sensible for binary responses.</p></dd>


</dl></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="pense_cv.html">pense_cv()</a></code> to compute the starting S-estimate.</p>
<p>Other functions to compute robust estimates with CV: 
<code><a href="pense_cv.html">pense_cv</a>()</code>,
<code><a href="regmest_cv.html">regmest_cv</a>()</code></p></div>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by David Kepplinger, Matías Salibián-Barrera, Gabriela Cohen Freue.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

