<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Compute (Adaptive) Elastic Net M-Estimates of Regression — regmest • pense</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Compute (Adaptive) Elastic Net M-Estimates of Regression — regmest" />
<meta property="og:description" content="Compute elastic net M-estimates along a grid of penalization levels with optional
penalty loadings for adaptive elastic net." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pense</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0.2.100</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/computing_adapense.html">Estimating predictive models</a>
    </li>
    <li>
      <a href="../articles/lambda_grids.html">Controlling the grid of penalization levels</a>
    </li>
    <li>
      <a href="../articles/migration_guide.html">Migrating from pense version 1.x to 2.x</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/dakep/pense-rpkg/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compute (Adaptive) Elastic Net M-Estimates of Regression</h1>
    <small class="dont-index">Source: <a href='https://github.com/dakep/pense-rpkg/blob/master/R/regmest_regression.R'><code>R/regmest_regression.R</code></a></small>
    <div class="hidden name"><code>regmest.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Compute elastic net M-estimates along a grid of penalization levels with optional
penalty loadings for adaptive elastic net.</p>
    </div>

    <pre class="usage"><span class='fu'>regmest</span>(
  <span class='kw'>x</span>,
  <span class='kw'>y</span>,
  <span class='kw'>alpha</span>,
  nlambda = <span class='fl'>50</span>,
  <span class='kw'>lambda</span>,
  <span class='kw'>lambda_min_ratio</span>,
  <span class='kw'>scale</span>,
  <span class='kw'>starting_points</span>,
  <span class='kw'>penalty_loadings</span>,
  intercept = <span class='fl'>TRUE</span>,
  cc = <span class='fl'>4.7</span>,
  eps = <span class='fl'>1e-06</span>,
  explore_solutions = <span class='fl'>10</span>,
  explore_tol = <span class='fl'>0.1</span>,
  max_solutions = <span class='fl'>10</span>,
  comparison_tol = <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span>(<span class='kw'>eps</span>),
  sparse = <span class='fl'>FALSE</span>,
  ncores = <span class='fl'>1</span>,
  standardize = <span class='fl'>TRUE</span>,
  algorithm_opts = <span class='fu'><a href='mm_algorithm_options.html'>mm_algorithm_options</a></span>(),
  add_zero_based = <span class='fl'>TRUE</span>,
  mscale_bdp = <span class='fl'>0.25</span>,
  mscale_opts = <span class='fu'><a href='mscale_algorithm_options.html'>mscale_algorithm_options</a></span>()
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p><code>n</code> by <code>p</code> matrix of numeric predictors.</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>vector of response values of length <code>n</code>.
For binary classification, <code>y</code> should be a factor with 2 levels.</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>elastic net penalty mixing parameter with \(0 \le \alpha \le 1\). <code>alpha = 1</code> is the LASSO penalty,
and <code>alpha = 0</code> the Ridge penalty.</p></td>
    </tr>
    <tr>
      <th>nlambda</th>
      <td><p>number of penalization levels.</p></td>
    </tr>
    <tr>
      <th>lambda</th>
      <td><p>optional user-supplied sequence of penalization levels. If given and not <code>NULL</code>, <code>nlambda</code> and
<code>lambda_min_ratio</code> are ignored.</p></td>
    </tr>
    <tr>
      <th>lambda_min_ratio</th>
      <td><p>Smallest value of the penalization level as a fraction of the largest level (i.e., the
smallest value for which all coefficients are zero). The default depends on the sample
size relative to the number of variables and <code>alpha</code>. If more observations than variables
are available, the default is <code>1e-3 * alpha</code>, otherwise <code>1e-2 * alpha</code>.</p></td>
    </tr>
    <tr>
      <th>scale</th>
      <td><p>fixed scale of the residuals.</p></td>
    </tr>
    <tr>
      <th>starting_points</th>
      <td><p>a list of staring points, created by <code><a href='starting_point.html'>starting_point()</a></code>. The starting points are shared
among all penalization levels.</p></td>
    </tr>
    <tr>
      <th>penalty_loadings</th>
      <td><p>a vector of positive penalty loadings (a.k.a. weights) for different penalization of each
coefficient. Only allowed for <code>alpha</code> &gt; 0.</p></td>
    </tr>
    <tr>
      <th>intercept</th>
      <td><p>include an intercept in the model.</p></td>
    </tr>
    <tr>
      <th>cc</th>
      <td><p>cutoff constant for Tukey's bisquare \(\rho\) function.</p></td>
    </tr>
    <tr>
      <th>eps</th>
      <td><p>numerical tolerance.</p></td>
    </tr>
    <tr>
      <th>explore_solutions</th>
      <td><p>number of solutions to compute up to the desired precision <code>eps</code>.</p></td>
    </tr>
    <tr>
      <th>explore_tol</th>
      <td><p>numerical tolerance for exploring possible solutions. Should be (much) looser than <code>eps</code> to
be useful.</p></td>
    </tr>
    <tr>
      <th>max_solutions</th>
      <td><p>only retain up to <code>max_solutions</code> unique solutions per penalization level.</p></td>
    </tr>
    <tr>
      <th>comparison_tol</th>
      <td><p>numeric tolerance to determine if two solutions are equal. The comparison is first done
on the absolute difference in the value of the objective function at the solution
If this is less than <code>comparison_tol</code>, two solutions are deemed equal if the squared difference
of the intercepts is less than <code>comparison_tol</code> and the squared \(L_2\) norm of the
difference vector is less than <code>comparison_tol</code>.</p></td>
    </tr>
    <tr>
      <th>sparse</th>
      <td><p>use sparse coefficient vectors.</p></td>
    </tr>
    <tr>
      <th>ncores</th>
      <td><p>number of CPU cores to use in parallel. By default, only one CPU core is used. May not be supported
on your platform, in which case a warning is given.</p></td>
    </tr>
    <tr>
      <th>standardize</th>
      <td><p>logical flag to standardize the <code>x</code> variables prior to fitting the M-estimates.
Coefficients are always returned on the original scale. This can fail for variables with a large
proportion of a single value (e.g., zero-inflated data). In this case, either compute with
<code>standardize = FALSE</code> or standardize the data manually.</p></td>
    </tr>
    <tr>
      <th>algorithm_opts</th>
      <td><p>options for the MM algorithm to compute estimates. See <code><a href='mm_algorithm_options.html'>mm_algorithm_options()</a></code> for details.</p></td>
    </tr>
    <tr>
      <th>add_zero_based</th>
      <td><p>also consider the 0-based regularization path in addition to the given starting points.</p></td>
    </tr>
    <tr>
      <th>mscale_bdp, mscale_opts</th>
      <td><p>options for the M-scale estimate used to standardize the predictors
(if <code>standardize = TRUE</code>).</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a list-like object with the following items</p><dl>
<dt><code>lambda</code></dt><dd><p>the sequence of penalization levels.</p></dd>
<dt><code>scale</code></dt><dd><p>the used scale of the residuals.</p></dd>
<dt><code>estimates</code></dt><dd><p>a list of estimates. Each estimate contains the following information:
<dl>
<dt><code>intercept</code></dt><dd><p>intercept estimate.</p></dd>
<dt><code>beta</code></dt><dd><p>beta (slope) estimate.</p></dd>
<dt><code>lambda</code></dt><dd><p>penalization level at which the estimate is computed.</p></dd>
<dt><code>alpha</code></dt><dd><p><em>alpha</em> hyper-parameter at which the estimate is computed.</p></dd>
<dt><code>objf_value</code></dt><dd><p>value of the objective function at the solution.</p></dd>
<dt><code>statuscode</code></dt><dd><p>if <code>&gt; 0</code> the algorithm experienced issues when computing the estimate.</p></dd>
<dt><code>status</code></dt><dd><p>optional status message from the algorithm.</p></dd></dl></p></dd>
<dt><code>call</code></dt><dd><p>the original call.</p></dd>

</dl>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='regmest_cv.html'>regmest_cv()</a></code> for selecting hyper-parameters via cross-validation.</p>
<p><code><a href='coef.pense_fit.html'>coef.pense_fit()</a></code> for extracting coefficient estimates.</p>
<p><code><a href='plot.pense_fit.html'>plot.pense_fit()</a></code> for plotting the regularization path.</p>
<p>Other functions to compute robust estimates: 
<code><a href='pense.html'>pense</a>()</code></p></div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by David Kepplinger, Matías Salibián-Barrera, Gabriela Cohen Freue.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


